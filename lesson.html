<!-- AI Tutor Floating Button -->
<button id="ai-tutor-fab" aria-label="Open AI Tutor" title="AI Medical Tutor">
  <!-- chat icon -->
  <svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
    <path fill="white" d="M2 12a10 10 0 1010-10A10 10 0 002 12zm11-1h-6v2h6v-2zm2-3h-8v2h8V8zm0 6h-8v2h8v-2z"></path>
  </svg>
</button>

<!-- Chat overlay / window -->
<div id="chat-overlay" aria-hidden="true">
  <div id="chat-window" role="dialog" aria-modal="true" aria-label="AI Medical Tutor Window">
    <div class="chat-header">
      <div class="chat-title">
        <img src="assets/ai-avatar.png" alt="" class="chat-avatar" style="display:none;">
        <h3>AI Medical Tutor</h3>
        <small id="lesson-context-summary" style="display:block;font-size:0.8rem;opacity:0.85;"></small>
      </div>
      <div class="chat-controls">
        <button id="export-chat-btn" title="Export chat">Export</button>
        <button id="close-chat-btn" aria-label="Close chat">&times;</button>
      </div>
    </div>

    <div id="chat-messages" role="log" aria-live="polite"></div>

    <div class="quick-prompts" id="quick-prompts">
      <button data-prompt="Summarize the lesson in 4 bullets.">Summarize</button>
      <button data-prompt="Explain like I'm a 3rd year medical student.">Explain (3rd year)</button>
      <button data-prompt="Give 5 short exam-style MCQs about this lesson.">Make Quiz</button>
    </div>

    <form id="chat-input-form" class="chat-input-form" autocomplete="off">
      <input type="text" id="chat-input" placeholder="Ask a question about this lesson..." aria-label="Ask question">
      <button id="chat-send-btn" type="submit" aria-label="Send">Send</button>
    </form>

    <div id="ai-status" style="font-size:0.75rem;padding:6px 12px;color:#555;display:flex;gap:8px;align-items:center;">
      <span id="key-status">Key: <strong id="key-flag">Not set</strong></span>
      <button id="set-key-btn" style="margin-left:auto;">Set API Key</button>
    </div>
  </div>
</div>
